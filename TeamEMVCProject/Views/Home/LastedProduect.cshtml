@using TeamEMVCProject.Models
@model TeamEMVCProject.Models.LastProductedModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";

    Session["Index"] = "0";
    

    DbHelper db = new DbHelper();

    //最近作品列表信息
    Array lastProducts = db.LastProductedModule.ToArray();
    const int MAX_ROW = 3;
    int temCouter = 1;
    int currentCounter = 1;
    List<TeamEMVCProject.Models.LastProductedModel> RowTempSrc = new List<TeamEMVCProject.Models.LastProductedModel>();
    Dictionary<int, List<TeamEMVCProject.Models.LastProductedModel>> PicDisplay = new Dictionary<int, List<TeamEMVCProject.Models.LastProductedModel>>();

    Array.Reverse(lastProducts);
    foreach (TeamEMVCProject.Models.LastProductedModel lp in lastProducts)
    {
        temCouter = temCouter % (MAX_ROW + 1);
        if (temCouter == 0) { RowTempSrc = new List<TeamEMVCProject.Models.LastProductedModel>(); temCouter++; }

        if (temCouter < MAX_ROW)
        {
            RowTempSrc.Add(lp);
        } 
        else if (temCouter == MAX_ROW)
        {
            RowTempSrc.Add(lp);
            PicDisplay.Add(currentCounter, RowTempSrc);
            currentCounter++;
        }
        temCouter++;
    } 
}

 <div class="content-block" >
        <div class="container">
            <header class="block-heading cleafix">
                <h1>近期作品展示</h1>
                <p> Game : ONE-THIRD LIFE CHOICES</p>
            </header>

            <section class="block-body">

                <div class="row">
                   @Html.Partial("~/Views/Partials/Carousel.cshtml")
                </div>

                <a class="btn btn-primary" role="button" data-toggle="collapse" href="#collapsePanel" aria-expanded="false" aria-controls="collapsePanel">
                    所有作品
                </a>
                <div class="collapse" id="collapsePanel">
                    <div class="well">
                        @{
                            foreach (var item in PicDisplay)
                            {
                                <div class="row">

                                    @foreach (var i in item.Value)
                                    {
                                        string src = "../" + i.ProductImgSrc;
                                        <div class="col-sm-4">
                                            <a class="recent-work" style="background-image:url(@src)">
                                                <span class="btn btn-o-white" data-toggle="modal" data-target="#CurrentPicture" data-imgsrcaddress=@src data-titleinfo=@i.ProductName>查看</span>
                                            </a>
                                        </div>
                                    }
                                </div>
                            }
                        }
                    </div>
                </div>
            </section>


            @Html.Partial("~/Views/Partials/ModalComponent.cshtml");

        </div>
 </div>

